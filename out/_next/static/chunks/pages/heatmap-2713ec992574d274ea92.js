_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[12],{"0zT2":function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/heatmap",function(){return r("u4vX")}])},u4vX:function(e,t,r){"use strict";r.r(t),r.d(t,"__N_SSG",(function(){return O})),r.d(t,"default",(function(){return x}));var n=r("o0o1"),o=r.n(n),c=r("nKUr"),a=r("HaE+"),s=r("rePB"),i=r("UP1k"),u=r("q1tI"),l=r("jA0i"),p=r("g4pe"),d=r.n(p),b=r("TBFr");function j(e){var t=e.exposure,r=e.close;return console.log(t),Object(c.jsx)(i.e,{closeOnClick:!1,onClose:r,longitude:t.coord.long,latitude:t.coord.lat,children:Object(c.jsxs)("div",{className:"cursor-default",children:[Object(c.jsxs)("div",{className:"border-b border-gray-500 pb-1 mb-1 text-center",children:[Object(c.jsx)("h3",{className:"text-xl font-semibold",children:t.name}),Object(c.jsx)("p",{className:"text-gray-500 text-xs -mt-1",children:t.address}),Object(c.jsx)("a",{href:t.scraper.URL,className:"underline text-blue-500 cursor-pointer",children:t.scraper.URL})]}),Object(c.jsx)(f,{perPage:4,times:t})]})})}function f(e){e.times,e.perPage;return Object(c.jsx)("div",{children:"DEMO REMOVED... showed paginated times & instructions for the location"})}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=!0;function x(e){var t=e.apiKey,r=e.exposures,n=Object(u.useState)({latitude:44.65107,longitude:-63.582687,zoom:11}),s=n[0],p=n[1];Object(u.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){var t=e.coords;p({zoom:11,latitude:t.latitude,longitude:t.longitude}),x()}))}),[]);var f=Object(u.useRef)(null),h=Object(u.useState)({input:null,exposures:r.map((function(e){return m(m({},e),{},{long:e.coord.long,lat:e.coord.lat})}))}),O=h[0];h[1];function x(){return w.apply(this,arguments)}function w(){return(w=Object(a.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=Object(u.useMemo)((function(){return function(){return{type:"FeatureCollection",features:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.long,e.lat]},properties:{_id:e._id}}}))}}(O.exposures)}),[O.exposures]),_=Object(u.useState)(null),P=_[0],N=_[1];function k(){return(k=Object(a.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=t.features.length){e.next=2;break}return e.abrupt("return",N(null));case 2:if(n=t.features[0].properties,l.Types.ObjectId.isValid(n._id)){e.next=5;break}return e.abrupt("return",N(null));case 5:N(r[r.findIndex((function(e){return e._id==n._id}))]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.jsxs)(b.a,{className:"h-screen",children:[Object(c.jsx)(d.a,{children:Object(c.jsx)("link",{href:"https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css",rel:"stylesheet"})}),Object(c.jsxs)("div",{className:"h-full pb-12",children:[Object(c.jsx)("p",{className:"text-center",children:"Showing all COVID exposure locations in the demo database"}),Object(c.jsxs)(i.h,m(m({mapboxApiAccessToken:t,reuseMaps:!0,dragRotate:!1,width:"100%",height:"100%",mapStyle:"mapbox://styles/mapbox/streets-v11"},s),{},{onViewportChange:function(e){p({longitude:e.longitude,latitude:e.latitude,zoom:e.zoom}),x()},ref:f,onClick:function(e){return k.apply(this,arguments)},children:[Object(c.jsx)(i.d,{showZoom:!0,showCompass:!1}),Object(c.jsx)(i.a,{className:"right-0"}),Object(c.jsxs)(i.f,{type:"geojson",data:v,children:[Object(c.jsx)(i.b,{type:"circle",paint:{"circle-radius":15,"circle-opacity":y(s.zoom),"circle-stroke-opacity":y(s.zoom),"circle-stroke-width":1,"circle-color":"#fff"}}),Object(c.jsx)(i.b,{type:"heatmap",paint:{"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],"heatmap-intensity":g(s.zoom),"heatmap-opacity":.67,"heatmap-radius":30}})]}),P&&Object(c.jsx)(j,{exposure:P,close:function(){return N(null)}})]}))]})]})}function g(e){var t=e<=6.3?.13706*e-.16347:-.09708*e+1.32063;return Math.max(t,0)}function y(e){return Math.max(0,Math.min(1,e-12))}}},[["0zT2",0,2,4,6,1,3,5]]]);